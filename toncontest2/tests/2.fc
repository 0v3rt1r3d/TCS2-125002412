int get_single_int(cell dict, int key_len, int key) inline method_id {
  (slice res, int ok) = dict.idict_get?(key_len, key);
  throw_if(100, ~ ok);
  (_, int value) = res.load_int(key_len);
  return value;
}

cell cell_with_int(int key_len, int value) inline method_id {
  return begin_cell().store_int(value, key_len).end_cell();
}

[int, tuple, cell, tuple, int] both_empty_data() method_id(0) {
	tuple stack = unsafe_tuple([new_dict(), new_dict()]);
  cell data = begin_cell().end_cell();

  int function_selector = 79555;
  return [function_selector, stack, data, get_c7(), null()];
}

_ both_empty_test(int exit_code, cell data, tuple stack, cell actions, int gas) method_id(1) {
  throw_if(exit_code, exit_code != 0);

  ;; Both merged and discarded are null
  throw_if(100, ~ cell_null?(stack.at(0)));
  throw_if(100, ~ cell_null?(stack.at(1)));
}

[int, tuple, cell, tuple, int] few_elements_data() method_id(2) {
  int key_len = 256;

  cell dict1 = new_dict();
  dict1~idict_set(key_len, 1, cell_with_int(key_len, 1).begin_parse());
  dict1~idict_set(key_len, 2, cell_with_int(key_len, 2).begin_parse());
  dict1~idict_set(key_len, 3, cell_with_int(key_len, 3).begin_parse());

  cell dict2 = new_dict();
  dict2~idict_set(key_len, 1, cell_with_int(key_len, 2).begin_parse());
  dict2~idict_set(key_len, 2, cell_with_int(key_len, 1).begin_parse());
  dict2~idict_set(key_len, 4, cell_with_int(key_len, 3).begin_parse());

	tuple stack = unsafe_tuple([dict1, dict2]);

  cell data = begin_cell().end_cell();
  int function_selector = 79555;
  return [function_selector, stack, data, get_c7(), null()];
}

_ few_elements(int exit_code, cell data, tuple stack, cell actions, int gas) method_id(3) {
  int key_len = 256;
  throw_if(exit_code, exit_code != 0);

  cell merged = stack.at(0);
  cell discarded = stack.at(1);

  { ;; Check merged
    throw_if(2, merged.get_single_int(key_len, 1) != 1);
    throw_if(2, merged.get_single_int(key_len, 2) != 2);
    throw_if(2, merged.get_single_int(key_len, 3) != 3);
    throw_if(2, merged.get_single_int(key_len, 4) != 3);
  }

  { ;; Check discarded
    throw_if(2, discarded.get_single_int(key_len, 1) != 2);
    throw_if(2, discarded.get_single_int(key_len, 2) != 1);
  }
}

[int, tuple, cell, tuple, int] first_is_empty_data() method_id(4) {
  int key_len = 256;

  cell dict1 = new_dict();

  cell dict2 = new_dict();
  dict2~idict_set(key_len, 1, cell_with_int(key_len, 1).begin_parse());
  dict2~idict_set(key_len, 50, cell_with_int(key_len, 50).begin_parse());
  dict2~idict_set(key_len, 100, cell_with_int(key_len, 100).begin_parse());

	tuple stack = unsafe_tuple([dict1, dict2]);

  cell data = begin_cell().end_cell();
  int function_selector = 79555;
  return [function_selector, stack, data, get_c7(), null()];
}

_ first_is_empty(int exit_code, cell data, tuple stack, cell actions, int gas) method_id(5) {
  int key_len = 256;
  throw_if(exit_code, exit_code != 0);

  ;; Check merged
  cell merged = stack.at(0);
  throw_if(100, merged.get_single_int(key_len, 1) != 1);
  throw_if(100, merged.get_single_int(key_len, 50) != 50);
  throw_if(100, merged.get_single_int(key_len, 100) != 100);

  ;; Check discarded
  cell discarded = stack.at(1);
  throw_if(2, ~ dict_empty?(discarded));
}

;; [int, tuple, cell, tuple, int] second_is_empty_data() method_id(6) {
;;   int key_len = 256;

;;   slice value1 = begin_cell().store_int(1, key_len).end_cell().begin_parse();
;;   slice value2 = begin_cell().store_int(2, key_len).end_cell().begin_parse();
;;   slice value3 = begin_cell().store_int(3, key_len).end_cell().begin_parse();

;;   cell dict1 = new_dict();
;;   dict1~idict_set(key_len, 1, value1);
;;   dict1~idict_set(key_len, 2, value2);
;;   dict1~idict_set(key_len, 3, value3);

;;   cell dict2 = new_dict();
;;   dict2~idict_set(key_len, 1, value2);
;;   dict2~idict_set(key_len, 2, value1);
;;   dict2~idict_set(key_len, 4, value3);

;; 	tuple stack = unsafe_tuple([dict1, dict2]);

;;   cell data = begin_cell().end_cell();
;;   int function_selector = 79555;
;;   return [function_selector, stack, data, get_c7(), null()];
;; }

;; _ second_is_empty(int exit_code, cell data, tuple stack, cell actions, int gas) method_id(7) {
;;   int key_len = 256;
;;   throw_if(exit_code, exit_code != 0);

;;   cell merged = stack.at(0);
;;   cell discarded = stack.at(1);

;;   { ;; Check merged
;;     throw_if(2, merged.get_single_int(key_len, 1) != 1);
;;     throw_if(2, merged.get_single_int(key_len, 2) != 2);
;;     throw_if(2, merged.get_single_int(key_len, 3) != 3);
;;     throw_if(2, merged.get_single_int(key_len, 4) != 3);
;;   }

;;   { ;; Check discarded
;;     throw_if(2, discarded.get_single_int(key_len, 1) != 2);
;;     throw_if(2, discarded.get_single_int(key_len, 2) != 1);
;;   }
;; }


;; [int, tuple, cell, tuple, int] all_are_intersected_data() method_id(8) {
;;   int key_len = 256;

;;   slice value1 = begin_cell().store_int(1, key_len).end_cell().begin_parse();
;;   slice value2 = begin_cell().store_int(2, key_len).end_cell().begin_parse();
;;   slice value3 = begin_cell().store_int(3, key_len).end_cell().begin_parse();

;;   cell dict1 = new_dict();
;;   dict1~idict_set(key_len, 1, value1);
;;   dict1~idict_set(key_len, 2, value2);
;;   dict1~idict_set(key_len, 3, value3);

;;   cell dict2 = new_dict();
;;   dict2~idict_set(key_len, 1, value2);
;;   dict2~idict_set(key_len, 2, value1);
;;   dict2~idict_set(key_len, 4, value3);

;; 	tuple stack = unsafe_tuple([dict1, dict2]);

;;   cell data = begin_cell().end_cell();
;;   int function_selector = 79555;
;;   return [function_selector, stack, data, get_c7(), null()];
;; }

;; _ all_are_intersected(int exit_code, cell data, tuple stack, cell actions, int gas) method_id(9) {
;;   int key_len = 256;
;;   throw_if(exit_code, exit_code != 0);

;;   cell merged = stack.at(0);
;;   cell discarded = stack.at(1);

;;   { ;; Check merged
;;     throw_if(2, merged.get_single_int(key_len, 1) != 1);
;;     throw_if(2, merged.get_single_int(key_len, 2) != 2);
;;     throw_if(2, merged.get_single_int(key_len, 3) != 3);
;;     throw_if(2, merged.get_single_int(key_len, 4) != 3);
;;   }

;;   { ;; Check discarded
;;     throw_if(2, discarded.get_single_int(key_len, 1) != 2);
;;     throw_if(2, discarded.get_single_int(key_len, 2) != 1);
;;   }
;; }

;; [int, tuple, cell, tuple, int] stress_test_data() method_id(10) {
;;   int key_len = 256;

;;   slice value1 = begin_cell().store_int(1, key_len).end_cell().begin_parse();
;;   slice value2 = begin_cell().store_int(2, key_len).end_cell().begin_parse();
;;   slice value3 = begin_cell().store_int(3, key_len).end_cell().begin_parse();

;;   cell dict1 = new_dict();
;;   dict1~idict_set(key_len, 1, value1);
;;   dict1~idict_set(key_len, 2, value2);
;;   dict1~idict_set(key_len, 3, value3);

;;   cell dict2 = new_dict();
;;   dict2~idict_set(key_len, 1, value2);
;;   dict2~idict_set(key_len, 2, value1);
;;   dict2~idict_set(key_len, 4, value3);

;; 	tuple stack = unsafe_tuple([dict1, dict2]);

;;   cell data = begin_cell().end_cell();
;;   int function_selector = 79555;
;;   return [function_selector, stack, data, get_c7(), null()];
;; }

;; _ stress_test(int exit_code, cell data, tuple stack, cell actions, int gas) method_id(11) {
;;   int key_len = 256;
;;   throw_if(exit_code, exit_code != 0);

;;   cell merged = stack.at(0);
;;   cell discarded = stack.at(1);

;;   { ;; Check merged
;;     throw_if(2, merged.get_single_int(key_len, 1) != 1);
;;     throw_if(2, merged.get_single_int(key_len, 2) != 2);
;;     throw_if(2, merged.get_single_int(key_len, 3) != 3);
;;     throw_if(2, merged.get_single_int(key_len, 4) != 3);
;;   }

;;   { ;; Check discarded
;;     throw_if(2, discarded.get_single_int(key_len, 1) != 2);
;;     throw_if(2, discarded.get_single_int(key_len, 2) != 1);
;;   }
;; }
